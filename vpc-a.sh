##!/bin/bash

REGION=us-west-2
VPC_TEMPLATE=eks-vpc-stack.yaml
VPC_STACK_NAME="eks-vpc-a-stack"
VPC_NAME="EKS-VPC-A"
ROUTABLE_CIDR1="192.168.16.0/20"
ROUTABLE_CIDR2="192.168.32.0/20"
PUBLIC_ROUTABLE_SUBNET1_CIDR="192.168.16.0/24"
PUBLIC_ROUTABLE_SUBNET2_CIDR="192.168.17.0/24"
PRIVATE_ROUTABLE_SUBNET1_CIDR="192.168.18.0/24"
PRIVATE_ROUTABLE_SUBNET2_CIDR="192.168.19.0/24"

aws cloudformation deploy --stack-name $VPC_STACK_NAME --template-file $VPC_TEMPLATE --parameter-overrides \
VpcName=$VPC_NAME \
VpcBlock=$ROUTABLE_CIDR1 \
PeerVpcBlock=$ROUTABLE_CIDR2 \
Subnet01Block=$PUBLIC_ROUTABLE_SUBNET1_CIDR \
Subnet02Block=$PUBLIC_ROUTABLE_SUBNET2_CIDR \
Subnet01PrivateBlock=$PRIVATE_ROUTABLE_SUBNET1_CIDR \
Subnet02PrivateBlock=$PRIVATE_ROUTABLE_SUBNET2_CIDR \
--capabilities CAPABILITY_IAM --region $REGION